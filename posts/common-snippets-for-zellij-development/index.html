<!doctype html><html lang=en dir=auto data-theme=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Common snippets for developing Zellij plugins | blog.nerd.rocks</title><meta name=keywords content="zellij,rust,tdd,benchmarks"><meta name=description content="This page describes some common tasks and snippets that can be used for the plugin development. Snippets are written in Rust,
but the concepts should be transferable to other languages as well. All examples are based on the rust-plugin-example.
Non selectable plugins with permissions
If a plugin (like a statusbar) should be non selectable, zellij-tile
provides the function set_selectable(). When this function is directly called on plugin
initialization, a user won&rsquo;t be able to grant plugin permissions since the plugin cannot be
selected. Therefore the plugin should call set_selectable(false) after receiving the PermissionRequestResult."><meta name=author content><link rel=canonical href=https://blog.nerd.rocks/posts/common-snippets-for-zellij-development/><link crossorigin=anonymous href=/assets/css/stylesheet.612c040e31fe00fa2ca5f8aac43a14a61a45660cba47508c405a83f91e0f64f6.css integrity="sha256-YSwEDjH+APospfiqxDoUphpFZgy6R1CMQFqD+R4PZPY=" rel="preload stylesheet" as=style><link rel=icon href=https://blog.nerd.rocks/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://blog.nerd.rocks/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://blog.nerd.rocks/favicon-32x32.png><link rel=apple-touch-icon href=https://blog.nerd.rocks/apple-touch-icon.png><link rel=mask-icon href=https://blog.nerd.rocks/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://blog.nerd.rocks/posts/common-snippets-for-zellij-development/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51);color-scheme:dark}.list{background:var(--theme)}.toc{background:var(--entry)}}@media(prefers-color-scheme:light){.list::-webkit-scrollbar-thumb{border-color:var(--code-bg)}}</style></noscript><script>window.matchMedia("(prefers-color-scheme: dark)").matches?document.querySelector("html").dataset.theme="dark":document.querySelector("html").dataset.theme="light"</script><meta property="og:url" content="https://blog.nerd.rocks/posts/common-snippets-for-zellij-development/"><meta property="og:site_name" content="blog.nerd.rocks"><meta property="og:title" content="Common snippets for developing Zellij plugins"><meta property="og:description" content="This page describes some common tasks and snippets that can be used for the plugin development. Snippets are written in Rust, but the concepts should be transferable to other languages as well. All examples are based on the rust-plugin-example.
Non selectable plugins with permissions If a plugin (like a statusbar) should be non selectable, zellij-tile provides the function set_selectable(). When this function is directly called on plugin initialization, a user won’t be able to grant plugin permissions since the plugin cannot be selected. Therefore the plugin should call set_selectable(false) after receiving the PermissionRequestResult."><meta property="og:locale" content="en-us"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-05-10T07:19:02+02:00"><meta property="article:modified_time" content="2024-05-10T07:19:02+02:00"><meta property="article:tag" content="Zellij"><meta property="article:tag" content="Rust"><meta property="article:tag" content="Tdd"><meta property="article:tag" content="Benchmarks"><meta name=twitter:card content="summary"><meta name=twitter:title content="Common snippets for developing Zellij plugins"><meta name=twitter:description content="This page describes some common tasks and snippets that can be used for the plugin development. Snippets are written in Rust,
but the concepts should be transferable to other languages as well. All examples are based on the rust-plugin-example.
Non selectable plugins with permissions
If a plugin (like a statusbar) should be non selectable, zellij-tile
provides the function set_selectable(). When this function is directly called on plugin
initialization, a user won&rsquo;t be able to grant plugin permissions since the plugin cannot be
selected. Therefore the plugin should call set_selectable(false) after receiving the PermissionRequestResult."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://blog.nerd.rocks/posts/"},{"@type":"ListItem","position":2,"name":"Common snippets for developing Zellij plugins","item":"https://blog.nerd.rocks/posts/common-snippets-for-zellij-development/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Common snippets for developing Zellij plugins","name":"Common snippets for developing Zellij plugins","description":"This page describes some common tasks and snippets that can be used for the plugin development. Snippets are written in Rust, but the concepts should be transferable to other languages as well. All examples are based on the rust-plugin-example.\nNon selectable plugins with permissions If a plugin (like a statusbar) should be non selectable, zellij-tile provides the function set_selectable(). When this function is directly called on plugin initialization, a user won\u0026rsquo;t be able to grant plugin permissions since the plugin cannot be selected. Therefore the plugin should call set_selectable(false) after receiving the PermissionRequestResult.\n","keywords":["zellij","rust","tdd","benchmarks"],"articleBody":"This page describes some common tasks and snippets that can be used for the plugin development. Snippets are written in Rust, but the concepts should be transferable to other languages as well. All examples are based on the rust-plugin-example.\nNon selectable plugins with permissions If a plugin (like a statusbar) should be non selectable, zellij-tile provides the function set_selectable(). When this function is directly called on plugin initialization, a user won’t be able to grant plugin permissions since the plugin cannot be selected. Therefore the plugin should call set_selectable(false) after receiving the PermissionRequestResult.\nThe following code demonstrates the feature. Notice, that the plugin must subscribe to the PermissionRequestResult to receive it in the load() function. Then the event must be handled in the update() function.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 impl ZellijPlugin for State { fn load(\u0026mut self, configuration: BTreeMap\u003cString, String\u003e) { request_permission(\u0026[ PermissionType::ReadApplicationState, ]); subscribe(\u0026[ EventType::ModeUpdate, EventType::PermissionRequestResult, ]); } fn update(\u0026mut self, event: Event) -\u003e bool { let mut should_render = false; match event { // ... Event::PermissionRequestResult(result) =\u003e { set_selectable(false); } // ... } should_render } } Queuing events until PermissionsRequestResult is received Hence Zellij communicates via events with the plugin, a plugin needs to ensure that dependencies between these events, that are relevant for the logic of the plugin, are handled correctly. For example, when a plugin is started a second time, it will receive a few events (like ModeUpdate) before the PermissionRequestResult event is received. If a plugin calls a function as soon as the ModeUpdate event is received, that requires permissions, the function call would fail. Therefore the plugin needs to hold back events until the PermissionRequestResult is received.\nThe following code demonstrates how events can be stored into a queue, until the PermissionRequestResult is received. A Vec is used in the State struct for storing the events. Event handling is extracted into a separate function, such that it can be called in several places in the update() function. If PermissionRequestResult is not received, events will be pushed into the vector. As soon as the PermissionRequestResult is received, the vector will be emptied and all events will be processed sequentially.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 struct State { pending_events: Vec\u003cEvent\u003e, got_permissions: bool, } impl ZellijPlugin for State { // ... fn update(\u0026mut self, event: Event) -\u003e bool { if let Event::PermissionRequestResult(PermissionStatus::Granted) = event { self.got_permissions = true; // iterate through all cached events, if the PermissionRequestResult is // received and permissions are granted with it while !self.pending_events.is_empty() { let ev = self.pending_events.pop(); self.handle_event(ev.unwrap()); } } if !self.got_permissions { // store events in a vector until permissions were granted self.pending_events.push(event); return false; } // handle events normally, if permissions were granted self.handle_event(event) } // ... } impl State { // this function was previously the update() function fn handle_event(\u0026mut self, event: Event) -\u003e bool { let mut should_render = false; match event { Event::ModeUpdate(mouse_info) =\u003e { should_render = true; } } should_render } } Advanced logging \u0026 Tracing Tracing is a form of logging, which could help to trace calls through certain functions and files of the code. There is a tracing and a tracing-subscriber, which can be utilized to implement tracing within Zellij plugins. First add these two crates with cargo add tracing tracing-subscriber.\nNext add a function, that initializes the tracing.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 fn init_tracing() { use std::fs::File; use tracing_subscriber::{layer::SubscriberExt, util::SubscriberInitExt}; let file = File::create(\".zellij_plugin.log\"); let file = match file { Ok(file) =\u003e file, Err(error) =\u003e panic!(\"Error: {:?}\", error), }; let debug_log = tracing_subscriber::fmt::layer().with_writer(Arc::new(file)); tracing_subscriber::registry().with(debug_log).init(); tracing::info!(\"tracing initialized\"); } Call this function at the beginning of the load() function of your plugin. It will initialize the tracing crate and configure it, such that it will write into a log file, where the plugin is started. Then you can use the tracing crate, similarly to the log crate.\n1 2 3 4 tracing::debug!(\"tracing initialized\"); tracing::info!(\"tracing initialized\"); tracing::warning!(\"tracing initialized\"); tracing::error!(\"tracing initialized\"); Additionally, functions can be instrumented with tracing. For more details, please visit the documentation of the tracing crate at https://docs.rs/tracing/latest/tracing/.\n1 2 3 4 5 #[tracing::instrument] fn my_function() { // ... tracing::debug!(\"some tracing output\"); } ","wordCount":"755","inLanguage":"en","datePublished":"2024-05-10T07:19:02+02:00","dateModified":"2024-05-10T07:19:02+02:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://blog.nerd.rocks/posts/common-snippets-for-zellij-development/"},"publisher":{"@type":"Organization","name":"blog.nerd.rocks","logo":{"@type":"ImageObject","url":"https://blog.nerd.rocks/favicon.ico"}}}</script></head><body id=top><header class=header><nav class=nav><div class=logo><a href=https://blog.nerd.rocks/ accesskey=h title="blog.nerd.rocks (Alt + H)">blog.nerd.rocks</a><div class=logo-switches></div></div><ul id=menu><li><a href=https://blog.nerd.rocks/archives/ title=Archive><span>Archive</span></a></li><li><a href=https://blog.nerd.rocks/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li><li><a href=https://blog.nerd.rocks/tags/ title=Tags><span>Tags</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class="post-title entry-hint-parent" id=fb33ab8ed3a23121e83a7c898ae87b9a>Common snippets for developing Zellij plugins</h1><div class=post-meta><span title='2024-05-10 07:19:02 +0200 +0200'>2024-05-10</span></div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#non-selectable-plugins-with-permissions aria-label="Non selectable plugins with permissions">Non selectable plugins with permissions</a></li><li><a href=#queuing-events-until-permissionsrequestresult-is-received aria-label="Queuing events until PermissionsRequestResult is received">Queuing events until PermissionsRequestResult is received</a></li><li><a href=#advanced-logging--tracing aria-label="Advanced logging & Tracing">Advanced logging & Tracing</a></li></ul></div></details></div><div class=post-content><p>This page describes some common tasks and snippets that can be used for the plugin development. Snippets are written in Rust,
but the concepts should be transferable to other languages as well. All examples are based on the <a href=https://github.com/zellij-org/rust-plugin-example>rust-plugin-example</a>.</p><h2 id=non-selectable-plugins-with-permissions>Non selectable plugins with permissions<a hidden class=anchor aria-hidden=true href=#non-selectable-plugins-with-permissions>#</a></h2><p>If a plugin (like a statusbar) should be non selectable, <a href=https://docs.rs/zellij-tile/latest/zellij_tile/>zellij-tile</a>
provides the function <code>set_selectable()</code>. When this function is directly called on plugin
initialization, a user won&rsquo;t be able to grant plugin permissions since the plugin cannot be
selected. Therefore the plugin should call <code>set_selectable(false)</code> after receiving the <code>PermissionRequestResult</code>.</p><p>The following code demonstrates the feature. Notice, that the plugin must subscribe to the
<code>PermissionRequestResult</code> to receive it in the <code>load()</code> function. Then the event must be handled
in the <code>update()</code> function.</p><div class=highlight><div style=color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f849c"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f849c"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f849c"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f849c"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f849c"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f849c"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f849c"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f849c"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f849c"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f849c">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f849c">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f849c">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f849c">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f849c">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f849c">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f849c">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f849c">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f849c">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f849c">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f849c">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f849c">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f849c">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f849c">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f849c">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f849c">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f849c">26
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-rust data-lang=rust><span style=display:flex><span><span style=color:#cba6f7>impl</span> ZellijPlugin <span style=color:#cba6f7>for</span> State {
</span></span><span style=display:flex><span>    <span style=color:#cba6f7>fn</span> <span style=color:#89b4fa>load</span>(<span style=color:#89dceb;font-weight:700>&amp;</span><span style=color:#cba6f7>mut</span> <span style=color:#89dceb>self</span>, configuration: <span style=color:#f9e2af>BTreeMap</span><span style=color:#89dceb;font-weight:700>&lt;</span><span style=color:#89dceb>String</span>, <span style=color:#89dceb>String</span><span style=color:#89dceb;font-weight:700>&gt;</span>) {
</span></span><span style=display:flex><span>        request_permission(<span style=color:#89dceb;font-weight:700>&amp;</span>[
</span></span><span style=display:flex><span>            PermissionType::ReadApplicationState,
</span></span><span style=display:flex><span>        ]);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        subscribe(<span style=color:#89dceb;font-weight:700>&amp;</span>[
</span></span><span style=display:flex><span>            EventType::ModeUpdate,
</span></span><span style=display:flex><span>            EventType::PermissionRequestResult,
</span></span><span style=display:flex><span>        ]);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#cba6f7>fn</span> <span style=color:#89b4fa>update</span>(<span style=color:#89dceb;font-weight:700>&amp;</span><span style=color:#cba6f7>mut</span> <span style=color:#89dceb>self</span>, event: <span style=color:#f9e2af>Event</span>) -&gt; <span style=color:#f38ba8>bool</span> {
</span></span><span style=display:flex><span>        <span style=color:#f38ba8>let</span> <span style=color:#cba6f7>mut</span> should_render <span style=color:#89dceb;font-weight:700>=</span> <span style=color:#fab387>false</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#cba6f7>match</span> event {
</span></span><span style=display:flex><span>            <span style=color:#6c7086;font-style:italic>// ...
</span></span></span><span style=display:flex><span>            Event::PermissionRequestResult(result) <span style=color:#89dceb;font-weight:700>=&gt;</span> {
</span></span><span style=display:flex><span>                set_selectable(<span style=color:#fab387>false</span>);
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>            <span style=color:#6c7086;font-style:italic>// ...
</span></span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        should_render
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></td></tr></table></div></div><h2 id=queuing-events-until-permissionsrequestresult-is-received>Queuing events until PermissionsRequestResult is received<a hidden class=anchor aria-hidden=true href=#queuing-events-until-permissionsrequestresult-is-received>#</a></h2><p>Hence Zellij communicates via events with the plugin, a plugin needs to ensure that dependencies between these
events, that are relevant for the logic of the plugin, are handled correctly. For example, when a plugin is started
a second time, it will receive a few events (like <code>ModeUpdate</code>) before the <code>PermissionRequestResult</code> event is received.
If a plugin calls a function as soon as the <code>ModeUpdate</code> event is received, that requires permissions, the function
call would fail. Therefore the plugin needs to hold back events until the <code>PermissionRequestResult</code> is received.</p><p>The following code demonstrates how events can be stored into a queue, until the <code>PermissionRequestResult</code> is received.
A <code>Vec&lt;Event></code> is used in the <code>State</code> struct for storing the events. Event handling is extracted into a separate function,
such that it can be called in several places in the <code>update()</code> function. If <code>PermissionRequestResult</code> is not received,
events will be pushed into the vector. As soon as the <code>PermissionRequestResult</code> is received, the vector will be emptied
and all events will be processed sequentially.</p><div class=highlight><div style=color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f849c"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f849c"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f849c"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f849c"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f849c"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f849c"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f849c"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f849c"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f849c"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f849c">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f849c">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f849c">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f849c">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f849c">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f849c">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f849c">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f849c">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f849c">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f849c">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f849c">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f849c">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f849c">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f849c">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f849c">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f849c">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f849c">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f849c">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f849c">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f849c">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f849c">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f849c">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f849c">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f849c">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f849c">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f849c">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f849c">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f849c">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f849c">38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f849c">39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f849c">40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f849c">41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f849c">42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f849c">43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f849c">44
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f849c">45
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f849c">46
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f849c">47
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-rust data-lang=rust><span style=display:flex><span><span style=color:#cba6f7>struct</span> <span style=color:#f9e2af>State</span> {
</span></span><span style=display:flex><span>    pending_events: <span style=color:#89dceb>Vec</span><span style=color:#89dceb;font-weight:700>&lt;</span>Event<span style=color:#89dceb;font-weight:700>&gt;</span>,
</span></span><span style=display:flex><span>    got_permissions: <span style=color:#f38ba8>bool</span>,
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#cba6f7>impl</span> ZellijPlugin <span style=color:#cba6f7>for</span> State {
</span></span><span style=display:flex><span>    <span style=color:#6c7086;font-style:italic>// ...
</span></span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#cba6f7>fn</span> <span style=color:#89b4fa>update</span>(<span style=color:#89dceb;font-weight:700>&amp;</span><span style=color:#cba6f7>mut</span> <span style=color:#89dceb>self</span>, event: <span style=color:#f9e2af>Event</span>) -&gt; <span style=color:#f38ba8>bool</span> {
</span></span><span style=display:flex><span>        <span style=color:#cba6f7>if</span> <span style=color:#f38ba8>let</span> Event::PermissionRequestResult(PermissionStatus::Granted) <span style=color:#89dceb;font-weight:700>=</span> event {
</span></span><span style=display:flex><span>            <span style=color:#89dceb>self</span>.got_permissions <span style=color:#89dceb;font-weight:700>=</span> <span style=color:#fab387>true</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#6c7086;font-style:italic>// iterate through all cached events, if the PermissionRequestResult is
</span></span></span><span style=display:flex><span>            <span style=color:#6c7086;font-style:italic>// received and permissions are granted with it
</span></span></span><span style=display:flex><span>            <span style=color:#cba6f7>while</span> <span style=color:#89dceb;font-weight:700>!</span><span style=color:#89dceb>self</span>.pending_events.is_empty() {
</span></span><span style=display:flex><span>                <span style=color:#f38ba8>let</span> ev <span style=color:#89dceb;font-weight:700>=</span> <span style=color:#89dceb>self</span>.pending_events.pop();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                <span style=color:#89dceb>self</span>.handle_event(ev.unwrap());
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#cba6f7>if</span> <span style=color:#89dceb;font-weight:700>!</span><span style=color:#89dceb>self</span>.got_permissions {
</span></span><span style=display:flex><span>            <span style=color:#6c7086;font-style:italic>// store events in a vector until permissions were granted
</span></span></span><span style=display:flex><span>            <span style=color:#89dceb>self</span>.pending_events.push(event);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#cba6f7>return</span> <span style=color:#fab387>false</span>;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#6c7086;font-style:italic>// handle events normally, if permissions were granted
</span></span></span><span style=display:flex><span>        <span style=color:#89dceb>self</span>.handle_event(event)
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#6c7086;font-style:italic>// ...
</span></span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#cba6f7>impl</span> State {
</span></span><span style=display:flex><span>    <span style=color:#6c7086;font-style:italic>// this function was previously the update() function
</span></span></span><span style=display:flex><span>    <span style=color:#cba6f7>fn</span> <span style=color:#89b4fa>handle_event</span>(<span style=color:#89dceb;font-weight:700>&amp;</span><span style=color:#cba6f7>mut</span> <span style=color:#89dceb>self</span>, event: <span style=color:#f9e2af>Event</span>) -&gt; <span style=color:#f38ba8>bool</span> {
</span></span><span style=display:flex><span>        <span style=color:#f38ba8>let</span> <span style=color:#cba6f7>mut</span> should_render <span style=color:#89dceb;font-weight:700>=</span> <span style=color:#fab387>false</span>;
</span></span><span style=display:flex><span>        <span style=color:#cba6f7>match</span> event {
</span></span><span style=display:flex><span>            Event::ModeUpdate(mouse_info) <span style=color:#89dceb;font-weight:700>=&gt;</span> {
</span></span><span style=display:flex><span>                should_render <span style=color:#89dceb;font-weight:700>=</span> <span style=color:#fab387>true</span>;
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        should_render
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></td></tr></table></div></div><h2 id=advanced-logging--tracing>Advanced logging & Tracing<a hidden class=anchor aria-hidden=true href=#advanced-logging--tracing>#</a></h2><p>Tracing is a form of logging, which could help to trace calls through certain functions and files of the code.
There is a <code>tracing</code> and a <code>tracing-subscriber</code>, which can be utilized to implement tracing within Zellij plugins.
First add these two crates with <code>cargo add tracing tracing-subscriber</code>.</p><p>Next add a function, that initializes the tracing.</p><div class=highlight><div style=color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f849c"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f849c"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f849c"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f849c"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f849c"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f849c"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f849c"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f849c"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f849c"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f849c">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f849c">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f849c">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f849c">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f849c">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f849c">15
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-rust data-lang=rust><span style=display:flex><span><span style=color:#cba6f7>fn</span> <span style=color:#89b4fa>init_tracing</span>() {
</span></span><span style=display:flex><span>    <span style=color:#cba6f7>use</span> std::fs::File;
</span></span><span style=display:flex><span>    <span style=color:#cba6f7>use</span> tracing_subscriber::{layer::SubscriberExt, util::SubscriberInitExt};
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#f38ba8>let</span> file <span style=color:#89dceb;font-weight:700>=</span> File::create(<span style=color:#a6e3a1>&#34;.zellij_plugin.log&#34;</span>);
</span></span><span style=display:flex><span>    <span style=color:#f38ba8>let</span> file <span style=color:#89dceb;font-weight:700>=</span> <span style=color:#cba6f7>match</span> file {
</span></span><span style=display:flex><span>        <span style=color:#89dceb>Ok</span>(file) <span style=color:#89dceb;font-weight:700>=&gt;</span> file,
</span></span><span style=display:flex><span>        <span style=color:#89dceb>Err</span>(error) <span style=color:#89dceb;font-weight:700>=&gt;</span> <span style=color:#89b4fa>panic!</span>(<span style=color:#a6e3a1>&#34;Error: </span><span style=color:#a6e3a1>{:?}</span><span style=color:#a6e3a1>&#34;</span>, error),
</span></span><span style=display:flex><span>    };
</span></span><span style=display:flex><span>    <span style=color:#f38ba8>let</span> debug_log <span style=color:#89dceb;font-weight:700>=</span> tracing_subscriber::fmt::layer().with_writer(Arc::new(file));
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    tracing_subscriber::registry().with(debug_log).init();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    tracing::<span style=color:#89b4fa>info!</span>(<span style=color:#a6e3a1>&#34;tracing initialized&#34;</span>);
</span></span><span style=display:flex><span>}
</span></span></code></pre></td></tr></table></div></div><p>Call this function at the beginning of the <code>load()</code> function of your plugin. It will initialize the tracing crate and
configure it, such that it will write into a log file, where the plugin is started. Then you can use the tracing crate, similarly to
the log crate.</p><div class=highlight><div style=color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f849c">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f849c">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f849c">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f849c">4
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-rust data-lang=rust><span style=display:flex><span>    tracing::<span style=color:#89b4fa>debug!</span>(<span style=color:#a6e3a1>&#34;tracing initialized&#34;</span>);
</span></span><span style=display:flex><span>    tracing::<span style=color:#89b4fa>info!</span>(<span style=color:#a6e3a1>&#34;tracing initialized&#34;</span>);
</span></span><span style=display:flex><span>    tracing::<span style=color:#89b4fa>warning!</span>(<span style=color:#a6e3a1>&#34;tracing initialized&#34;</span>);
</span></span><span style=display:flex><span>    tracing::<span style=color:#89b4fa>error!</span>(<span style=color:#a6e3a1>&#34;tracing initialized&#34;</span>);
</span></span></code></pre></td></tr></table></div></div><p>Additionally, functions can be instrumented with tracing. For more details, please visit the documentation of the tracing
crate at <a href=https://docs.rs/tracing/latest/tracing/>https://docs.rs/tracing/latest/tracing/</a>.</p><div class=highlight><div style=color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f849c">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f849c">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f849c">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f849c">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f849c">5
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-rust data-lang=rust><span style=display:flex><span><span style=color:#6c7086;font-style:italic>#[tracing::instrument]</span>
</span></span><span style=display:flex><span><span style=color:#cba6f7>fn</span> <span style=color:#89b4fa>my_function</span>() {
</span></span><span style=display:flex><span>    <span style=color:#6c7086;font-style:italic>// ...
</span></span></span><span style=display:flex><span>    tracing::<span style=color:#89b4fa>debug!</span>(<span style=color:#a6e3a1>&#34;some tracing output&#34;</span>);
</span></span><span style=display:flex><span>}
</span></span></code></pre></td></tr></table></div></div></div><footer class=post-footer><ul class=post-tags><li><a href=https://blog.nerd.rocks/tags/zellij/>Zellij</a></li><li><a href=https://blog.nerd.rocks/tags/rust/>Rust</a></li><li><a href=https://blog.nerd.rocks/tags/tdd/>Tdd</a></li><li><a href=https://blog.nerd.rocks/tags/benchmarks/>Benchmarks</a></li></ul><nav class=paginav><a class=next href=https://blog.nerd.rocks/posts/getting-started-with-zellij-plugins/><span class=title>Next »</span><br><span>Getting started with developing Zellij plugins</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2026 <a href=https://blog.nerd.rocks/>blog.nerd.rocks</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");if(menu){const e=localStorage.getItem("menu-scroll-position");e&&(menu.scrollLeft=parseInt(e,10)),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}}document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>